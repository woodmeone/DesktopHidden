<?xml version="1.0" encoding="utf-8"?>
<UserControl
  x:Class="DesktopHidden.Views.SubZoneView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="using:DesktopHidden.Views"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:converters="using:DesktopHidden.Converters"
  mc:Ignorable="d"
  d:DesignHeight="150"
  d:DesignWidth="200">

  <UserControl.Resources>
    <converters:BooleanToLockIconConverter x:Key="BooleanToLockIconConverter" />
    <converters:BooleanToGridLengthConverter x:Key="BooleanToGridLengthConverter" />
    <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    <converters:ColorToBrushConverter x:Key="ColorToBrushConverter" />
    <Style x:Key="SubZoneNavBarButton" TargetType="Button">
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="Foreground" Value="White" />
      <Setter Property="Width" Value="30" />
      <Setter Property="Height" Value="30" />
      <Setter Property="BorderThickness" Value="0" />
      <Setter Property="Margin" Value="2,0" />
      <Setter Property="FontFamily" Value="Segoe Fluent Icons" />
      <Setter Property="FontSize" Value="12" />
    </Style>
  </UserControl.Resources>

  <Border x:ConnectionId='2' x:Name="SubZoneBorder" CornerRadius="5"
    Background="{Binding BackgroundColor, Converter={StaticResource ColorToBrushConverter}}"
    Opacity="{Binding Opacity}">
    <!-- Fallback Background for design time or if binding fails -->
    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="30" />
        <RowDefinition
          Height="{Binding IsContentVisible, Converter={StaticResource BooleanToGridLengthConverter}}" />
      </Grid.RowDefinitions>

      <!-- 顶部导航栏 -->
      <Grid x:ConnectionId='3' x:Name="NavBar" Grid.Row="0" Background="#99000000" HorizontalAlignment="Stretch"
        VerticalAlignment="Top"
                                              >
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
          <!-- 锁定按钮 -->
          <Button x:ConnectionId='8' Style="{StaticResource SubZoneNavBarButton}"                         >
            <FontIcon FontFamily="Segoe Fluent Icons"
              Glyph="{Binding IsLocked, Converter={StaticResource BooleanToLockIconConverter}}"
              Foreground="White" /> <!-- 明确设置前景颜色 -->
          </Button>

          <!-- 删除按钮 -->
          <Button x:ConnectionId='9' Style="{StaticResource SubZoneNavBarButton}"                           >
            <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE74D;" Foreground="White" /> <!--
            明确设置前景颜色 -->
          </Button>

          <!-- 下拉框按钮 (隐藏/显示内容) -->
          <Button x:ConnectionId='10' Style="{StaticResource SubZoneNavBarButton}"                                  >
            <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE70D;" Foreground="White" /> <!--
            明确设置前景颜色 -->
          </Button>

          <!-- 伪装按钮 -->
          <Button x:ConnectionId='11' Style="{StaticResource SubZoneNavBarButton}"                             >
            <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE7B3;" Foreground="White" /> <!--
            明确设置前景颜色 -->
          </Button>
        </StackPanel>
      </Grid>

      <!-- 内容区域 -->
      <Grid x:ConnectionId='4' x:Name="ContentArea" Grid.Row="1" Background="Transparent"
        Visibility="{Binding IsContentVisible, Converter={StaticResource BooleanToVisibilityConverter}}"
        AllowDrop="True"                                                        >
        <ItemsControl x:ConnectionId='5' x:Name="ShortcutItemsControl"
          ItemsSource="{Binding Shortcuts}"
          HorizontalAlignment="Left" VerticalAlignment="Top"
          Margin="5"
          ScrollViewer.VerticalScrollMode="Auto"
          ScrollViewer.HorizontalScrollMode="Disabled">
          <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
              <WrapGrid Orientation="Horizontal" />
            </ItemsPanelTemplate>
          </ItemsControl.ItemsPanel>
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <StackPanel x:ConnectionId='6' x:Name="ShortcutStackPanel" Orientation="Vertical" Margin="5" Width="60" Height="80"
                                                        
                                                            
                                                        
                                                              >
                <Grid>
                  <Image Source="{Binding Icon}" Width="32" Height="32" HorizontalAlignment="Center"
                    VerticalAlignment="Center" />
                  <!-- 删除按钮 -->
                  <Button x:ConnectionId='7' x:Name="DeleteShortcutButton" Content="&#xE74D;" FontFamily="Segoe Fluent Icons"
                    FontSize="12" Foreground="White" Background="#CCFF0000" HorizontalAlignment="Right"
                    VerticalAlignment="Top" Width="16" Height="16" Padding="0"
                    Style="{StaticResource SubZoneNavBarButton}"
                    Visibility="Collapsed"                                   >
                    <Button.Resources>
                      <Style TargetType="Button" BasedOn="{StaticResource SubZoneNavBarButton}" />
                    </Button.Resources>
                  </Button>
                </Grid>
                <TextBlock Text="{Binding Name}" TextWrapping="Wrap" TextAlignment="Center"
                  Foreground="White" FontSize="10" Margin="0,5,0,0" MaxLines="2" />
              </StackPanel>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </Grid>
    </Grid>
  </Border>
</UserControl>

